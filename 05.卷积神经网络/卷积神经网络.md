# 卷积神经网络

卷积神经网络(Convolutional Neural Network，CNN)，常用于图像处理和与之相似度高的方面。其设计过程可带来不少对设计神经网络架构的启发。

## 图像分类简介

图像分类任务是由机器从一张图片中识别出其中包含的物体，如猫、狗之类的。由于神经网络输入大小固定，所以也需要先将不同大小的图片使用图像处理的算法使其缩放至指定大小，再输入网络处理。模型的目标是分类，所以会把每一个类别表示成一个 One-Hot 的 Vector，我的目标就叫做 $\hat{y}$。在这个 One-Hot 的 Vector 中，假设类别是猫的话，猫所对应的 Dimension 数值就是 1，其他东西所对的 Dimension 数值就是 0。这个 Dimension 的长度就决定了，现在的模型可以辨识出多少不同种类的东西。

![](image/2021-07-24-21-11-48.png)

模型的输出通过 Softmax 以后，输出是 $y'$。希望 $y'$ 和$\hat{y}$的 Cross Entropy 越小越好，接下来的问题怎么**把一张影像当做一个模型的输入**。

对于一个 Machine 来说，一张图片其实是一个**三维的 Tensor**，其中一维代表图片的**宽**，另外一维代表图片的**高**，还有一维代表图片的 **Channel 的数目**。一张彩色的图片，它每一个 Pixel，都是由 R G B 三个顏色所组成的，所以这三个 Channel 就代表了 R G B 三个顏色，长跟宽就代表代表这张图片中的像素（Pixel）的数目。

![](image/2021-07-24-21-12-46.png)

 Network 的输入是一个向量，所以只要能够把一张图片变成一个向量，就可以把它当做是 Network 的输入。最直觉的方法就是直接拉直它。

在这个例子中有 100 × 100 × 3 个数字，拿出来排成一排，就是一个巨大的向量，可以作為 Network 的输入。每一个 Neuron 跟输入向量的每一个数值都会有一个 Weight，所以如果输入的向量长度是 100 × 100 × 3，有 1000 个 Neuron，那第一层的 Weight，就有 1000 × 100 × 100 × 3，也就是 $3×10^7$，是一个非常巨大的数目。

虽然随著参数的增加，可以增加模型的弹性，可以增加它的能力，但是也增加了 **Overfitting** 的风险（参考内容：吴培元老师<https://speech.ee.ntu.edu.tw/~hylee/ml/ml2021-course-data/W14_PAC-introduction.pdf>，概念上，如果模型的弹性越大，就越容易 Overfitting ）。

怎么减少在做影像辨识的时候怎么避免使用这麼多的参数呢。考虑到影像辨识这个问题本身的特性，其实并**不一定需要 Fully Connected** 这件事。不需要每一个 Neuron，跟 Input 的每一个 Dimension 都有一个 Weight。

## 图像特征识别

### 观察

第一个观察是，对影像辨识这个问题而言，假设想要知道这张图片中有一隻动物，这个动物是一个鸟，怎么做呢。也许对一个影像辨识的系统而言，对一个影像辨识的类神经网路中的神经而言，它要做的就是侦测现在这张图片中，有没有出现一些特别重要的 Pattern。

![](image/2021-07-24-21-25-43.png)

举例：

- 某个 Neuron 看到鸟嘴这个 Pattern
- 某个 Neuron 看到眼睛这个 Pattern
- 某个 Neuron 看到鸟爪这个 Pattern

也许看到这些 Pattern 综合起来就代表看到了一隻鸟，类神经网路就可以告诉你说，因為看到了这些 Pattern，所以它看到了一隻鸟。**类比人类**识别物体过程，是不是也是用同样的方法，来看一张图片中有没有一隻鸟呢？在判断一个物件的时候，往往也是抓最重要的特徵，然后看到这些特徵以后，你很直觉地就会觉得说，你看到了某种物件，对机器来说，也许这也是一个有效的，判断影像中有什麼物件的方法。

假设用 Neuron 做的事情，其实就是判断现在有没有某种 Pattern 出现，那也许并**不需要每一个 Neuron 都去看一张完整的图片**。因為这一些重要的 Pattern，比如说鸟嘴、眼睛、鸟爪，不需要在看整张完整的图片后，才能够得到，所以**这些 Neuron 也许根本就不需要把整张图片当作输入**。它们只需要把图片的一小部分当作输入，就足以让它们侦测某些特别关键的 Pattern有没有出现了。

### 简化

在 CNN 中有一个这样的做法，会设定一个区域叫做 Receptive Field ，**每一个 Neuron 都只关心自己的 Receptive Field 中发生的事情**。


